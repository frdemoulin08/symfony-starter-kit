{#
params:
- title (string)
- input_id (string) : id de l'input mot de passe à écouter
- items (array) : [{ text, type, min, max, param, pattern, optional }]
#}
{% set title = title|default('Contraintes de composition des mots de passe') %}
{% set input_id = input_id|default('user_plainPassword') %}
{% set allowed_specials %}!"#$%&'()*+,-./:;<=>?@[\]^_{|}~`€£¥§¤{% endset %}
{% set allowed_pattern %}^[A-Za-z0-9!"#$%&'()*+,\-./:;<=>?@\[\]\\^_{|}~`€£¥§¤]+${% endset %}
{% set items = items|default([
    { text: 'Entre 12 et 64 caractères', type: 'minmax', min: 12, max: 64 },
    { text: "Uniquement lettres non accentuées, chiffres et caractères spéciaux autorisés (pas d'espace ni d'accent)", type: 'allowed', pattern: allowed_pattern },
    { text: 'Au moins une minuscule, une majuscule, un chiffre et un caractère spécial', type: 'categories', param: 4 }
]) %}

<div data-password-requirements data-password-input="{{ input_id }}" class="text-sm text-body">
    <h2 class="mb-2 text-sm font-medium text-heading">{{ title }}</h2>
    <div class="mb-3 space-y-1">
        <p>Longueur : 12 à 64 caractères.</p>
        <p>Caractères autorisés : lettres non accentuées (a–z, A–Z), chiffres (0–9) et caractères spéciaux suivants :</p>
        <p class="font-mono text-body-subtle">{{ allowed_specials }}</p>
        <p>Les espaces, caractères accentués et caractères de contrôle ne sont pas autorisés.</p>
    </div>
    <ul class="w-full space-y-1 list-inside">
        {% for item in items %}
            <li class="flex items-center"
                data-requirement="{{ item.type }}"
                {% if item.min is defined %}data-requirement-min="{{ item.min }}"{% endif %}
                {% if item.max is defined %}data-requirement-max="{{ item.max }}"{% endif %}
                {% if item.param is defined %}data-requirement-param="{{ item.param }}"{% endif %}
                {% if item.pattern is defined %}data-requirement-pattern="{{ item.pattern|e('html_attr') }}"{% endif %}
                {% if item.optional is defined and item.optional %}data-requirement-optional="true"{% endif %}
                data-met="false">
                <svg class="h-4 w-4 text-body me-1.5 shrink-0" data-requirement-icon aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.707-9.707a1 1 0 0 0-1.414-1.414L9 10.172 7.707 8.879a1 1 0 1 0-1.414 1.414L9 13l4.707-4.707Z" clip-rule="evenodd"/>
                </svg>
                {{ item.text }}
            </li>
        {% endfor %}
    </ul>
</div>
